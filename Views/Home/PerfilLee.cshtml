@using Hiring.Models
@model Informacion_Personal_Empleado

@{ ViewData["Title"] = "Lee";}



<div class="container">
       <div class="card-container">
    <a data-bs-toggle="modal" data-bs-target="#ModalForm">
        <div class="rectangulo-encabezado" style="background-color: @Model.estilo;"></div>
        <div class="perfil-container">
            <img class="foto-perfil" src="@Model.foto_perfil" alt="Foto de perfil">
            <div class="info-perfil">
                <div class="perfil-header">
                    <h3 class="nombre-apellido">@Model.nombre_apellido</h3>
                    <img class="mini-foto" src="../img/logos/HirINg-app.gif" alt="Mini Foto">
                </div>
                <div class="profesion-container">
                    <i class="fas fa-briefcase profesion-icon"></i>
                    <p class="profesion" style="color: rgb(59, 59, 59) !important;">@Model.profesion_actual</p>
                </div>
            </div>
        </div>
        <hr style="color: @Model.estilo; margin-top: -35px; opacity: .5;">
        <div class="contact-info">
            <h5 class="telefono" style="background-color:@Model.estilo;">
                <i class="fa-solid fa-phone"></i> @Model.telefono
            </h5>
            <h5 class="mail" style="background-color:@Model.estilo;">
                <i class="fa-solid fa-envelope"></i> @Model.mail
            </h5>
            <h5 class="ubicacion" style="background-color:@Model.estilo;">
                <i class="fa-solid fa-location-dot"></i> @Model.ubicacion
            </h5>
        </div>
    </a>
            
            <div class="acerca_de_mi_container">
            <i  class="fa-solid fa-address-card"></i>
            <div class="acerca-de-mi"> 
            @Model.acerca_de_mi</div></div>
            <div class="upload-container">
                <img class="img_upload_archivos" src="../img/componente/subir_archivo.png" alt="Subir Archivos" class="upload-image" onclick="document.getElementById('fileInput').click()">
                <input type="file" id="fileInput" multiple style="display: none;" accept=".png, .jpg, .jpeg, .pdf, .txt, .mp3, .mp4" onchange="handleFiles(this.files)">
            </div>
            <div class="educacion-container">
                 <a data-bs-toggle="modal" data-bs-target="#ModalEducacion">
                <img class="img_upload_archivos" src="../img/componente/educacion.png" alt="Educacion">
                </a>
            </div>
            
            
            


     @if (ViewBag.UrlMultimedia != null){

    <div class="container carousel-container">
        <div id="carouselExampleAutoplaying" class="carousel slide carousel-fotos" data-bs-ride="carousel">
            <div class="carousel-inner" style="text-align: center; width: 100%;" id="carousel-inner">
                @{
                    bool Activo = true;
                    @foreach (string item in ViewBag.UrlMultimedia)
                    {
                        <div class='carousel-item @(Activo ? "active" : "")'>
                            <div class="row">
                                <div class="col-md-12">
                                    <img src="@item" class="d-block w-100">
                                </div>
                            </div>
                        </div>
                        Activo = false;
                    }
                }
            </div>
            <button class="button_boton carousel-control-prev" style="background-color: @Model.estilo;" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="button_boton carousel-control-next" type="button" style="background-color: @Model.estilo;" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>
}

        <!-- MODAL INFO PERSONAL -->
        <div class="modal fade" id="ModalForm" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div id="seccion1" class="modal-header">
                        <h5 class="modal-title">Información Personal </h5>
                    </div>
                    <div id="seccion1-body" class="modal-body">
                        @using(Html.BeginForm("InsertarInformacionPersonal1","Home",  FormMethod.Post, new {id="form-modal"}))
                        {
                            <div>
                                NOMBRE COMPLETO
                                @Html.TextBoxFor(model=>model.nombre_apellido, new {placeholder="Nombre y Apellido"})
                                EMAIL
                                @Html.TextBoxFor(model=>model.mail, new {placeholder="Correo electrónico",type="email"})
                                TELÉFONO
                                @Html.TextBoxFor(model=>model.telefono, new {placeholder="Teléfono"})
                                COLOR GENERAL
                                <input type="color" id="colorPicker" name="estilo" class="form-control mb-2" value="@Model.estilo" />
                                @Html.HiddenFor(model => model.id, new { placeholder = "Estilo" })
                            </div>
                            <div id="seccion1-footer" class="modal-footer">
                            <button type="submit" style="background-color: @Model.estilo; border-color: @Model.estilo" class="btn btn-primary">Guardar</button>
                            <button type="button" style="background-color: @Model.estilo ; border-color: @Model.estilo" class="btn btn-primary" onclick="mostrarSiguienteSeccion(2)">Siguiente</button>
                            </div>
                        }
            </div>
            <div id="seccion2" class="modal-header" style="display: none;">
                <h5 class="modal-title">Información Personal </h5>
            </div>
            <div id="seccion2-body" class="modal-body" style="display: none;">
                <form action='@Url.Action("InsertarInformacionPersonal2")' method="post" id="form-modal">
                    <div>
                    ACERCA DE MI
                    @Html.TextBoxFor(model=>model.acerca_de_mi, new {placeholder="Acerca De Mi"})
                    PROFESION
                    @Html.TextBoxFor(model=>model.profesion_actual, new {placeholder="Profesion"})
                    UBICACION
                    @Html.TextBoxFor(model=>model.ubicacion, new {placeholder="Ubicacion"})
                    FOTO DE PERFIL
                    @Html.TextBoxFor(model=>model.foto_perfil, new {placeholder="URL Foto de Perfil"})
                    @Html.HiddenFor(model=>model.id)
                    </div>
            <div id="seccion2-footer" class="modal-footer" style="display: none;">
                <button type="button" style="background-color: @Model.estilo ; border-color: @Model.estilo" class="btn btn-secondary" onclick="mostrarSiguienteSeccion(1)">Anterior</button>
                <button type="submit" style="background-color: @Model.estilo ;border-color: @Model.estilo" class="btn btn-primary">Guardar</button>
            </div>
            </form>
            </div>
        </div>
    </div>
</div>


    <!--MODAL EDUCACION -->
    <div class="modal fade" id="ModalEducacion" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div id="seccion1" class="modal-header">
                <h5 class="modal-title">Educación</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div id="seccion1-body" class="modal-body">
                <form>
                    <input type="text" name="titulo" placeholder="Título">
                    <input type="text" name="NombreInstitucion" placeholder="Nombre Institución">
                    <input type="text" name="DisciplinaAcademica" placeholder="Disciplina Académica">
                    <input type="text" name="ActividadesGrupo" placeholder="Actividades de Grupo">
                    <input type="text" name="Descripcion" placeholder="Descripción">
                    <input type="date" name="FechaExpedicion" placeholder="Fecha Expedición">
                    <input type="date" name="FechaCaducidad" placeholder="Fecha Caducidad">
                </form>

                @if (ViewBag.Lista_educacion != null)
                {
                    foreach (var item in ViewBag.Lista_educacion)
                    {
                        <div class="card_educacion">
                            <div class="container3__text">
                                <h1>@item.Titulo</h1>
                                <div class="container3__text__star">
                                    <span class="fa fa-star checked"></span>
                                    <span class="fa fa-star checked"></span>
                                    <span class="fa fa-star checked"></span>
                                    <span class="fa fa-star checked"></span>
                                    <span class="fa fa-star checked"></span>
                                </div>
                            </div>
                        </div>
                    }
                }
            </div>
                    <div id="seccion1-footer" class="modal-footer">
                        <button type="submit" class="btn btn-primary">Guardar</button>
                        <button type="button" class="btn btn-primary" onclick="mostrarSiguienteSeccion(2)">Siguiente</button>
                    </div>      
            </div>



                               <!-- Aca hago un form vacio con la info de educacion a completar

                                //Abajo de eso hago un foreach recorriengo el viewbag de la educcacion ya cargada, 
                                //COn un link de modificar (este debería cargar el form) y de eliminar-->
                            



    @{
        var modelId = Model.id;
    }
<script>
    function handleFiles(files) {
    const fileList = document.getElementById('fileList');
    var modelId = '@modelId';

    for (let i = 0; i < files.length; i++) {
        const file = files[i];
        const formData = new FormData();
        formData.append('file', file);
        formData.append('Id_Empleado', modelId);

        // Enviar el archivo al servidor
        $.ajax({
            url: '/Home/UploadFile',
            method: "POST",
            data: formData,
            contentType: false,
            processData: false,
            success: function(response) {
                console.log('Archivo subido correctamente');
                console.log(response);

                // Actualiza el carrusel con la nueva imagen
                let text = "";
                for (let i = 0; i < response.data.length; i++) {
                    text += "<div class='carousel-item " + (i == 0 ? "active" : "") + "'><div class='row'><div class='col-md-12'><img src='" + response.data[i] + "' class='d-block w-100'></div></div></div>";
                }
                $("#carousel-inner").html(text);
            },
            error: function(xhr, status, error) {
                console.error('Error al subir el archivo:', status, error);
            }
        });
    }
    updateSlides();
}

       
        
   



</script>

<style>
/*profesion */
.profesion-container {
    display: flex; 
    align-items: center; 
    margin-top: 10px; 
    color:black;
}

.profesion-icon {
    font-size: 20px; 
    margin-right: 8px; 
    color: @Model.estilo; 
}

.profesion {
    margin: 0; 
    color: rgb(59, 59, 59) !important;
    font-family: 'Sura', sans-serif;
}

</style>