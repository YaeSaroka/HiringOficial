@using Hiring.Models
@model Informacion_Personal_Empleado
@{
    ViewData["Title"] = "Lee";
}

 <div class="container">
        <div class="card-container">
            <a data-bs-toggle="modal" data-bs-target="#ModalForm">
                <div class="rectangulo-encabezado" style="background-color: @Model.estilo;"></div>
                <img class="foto-perfil" src="@Model.foto_perfil" alt="Foto de perfil">
                <h3 class="nombre-apellido">@Model.nombre_apellido  | <p id= "profesion" style="color:@Model.estilo;">@Model.profesion_actual </p></h3>
                
                <hr style="color: @Model.estilo;"><hr/>
                <div class="contact-info">
                    <h5 class="telefono" style="background-color:@Model.estilo;"> @Model.telefono </h5><p class="mail" style="background-color:@Model.estilo;">@Model.mail</p> <p class="ubicacion" style="background-color:@Model.estilo;">@Model.ubicacion</p>
                </div>
              
                
            </a>
            <hr style="color: @Model.estilo;"><hr/>
            <div class="acerca_de_mi_container">
            <div class="acerca-de-mi"> 
            @Model.acerca_de_mi</div></div>
            <div class="upload-container">
                <img class="img_upload_archivos" src="../img/componente/subir_archivo.png" alt="Subir Archivos" class="upload-image" onclick="document.getElementById('fileInput').click()">
                <input type="file" id="fileInput" multiple style="display: none;" accept=".png, .jpg, .jpeg, .pdf, .txt, .mp3, .mp4" onchange="handleFiles(this.files)">
            </div>
            <!--<div id="carouselExampleControls" class="carousel-container carousel slide">
                <div class="carousel-inner" id="fileList"></div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>-->
                <div id="CarouseLArchivos" class="carousel slide" style="display: none;">
                    <div class="carousel-inner" id="fileList"></div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#CarouseLArchivos" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#CarouseLArchivos" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
        </div>
    </div>

<div class="modal fade" id="ModalForm" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div id="seccion1" class="modal-header">
                <h5 class="modal-title">Información Personal - Parte 1</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div id="seccion1-body" class="modal-body">
                 @using(Html.BeginForm("InsertarInformacionPersonal1","Home",  FormMethod.Post, new {id="form-modal"}))
                {
                    <div>
                        @Html.TextBoxFor(model=>model.nombre_apellido, new {placeholder="Nombre y Apellido"})
                        @Html.TextBoxFor(model=>model.mail, new {placeholder="Correo electrónico",type="email"})
                        @Html.TextBoxFor(model=>model.telefono, new {placeholder="Teléfono"})
                        @Html.TextBoxFor(model=>model.estilo, new {placeholder="Estilo",  value="#"})
    

                        @Html.HiddenFor(model=>model.id)
                    </div>
                    <div id="seccion1-footer" class="modal-footer">
                    <button type="submit" class="btn btn-primary">Guardar</button>
                        <button type="button" class="btn btn-primary" onclick="mostrarSiguienteSeccion(2)">Siguiente</button>
                    </div>

                }
            </div>
            <div id="seccion2" class="modal-header" style="display: none;">
                <h5 class="modal-title">Información Personal - Parte 2</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div id="seccion2-body" class="modal-body" style="display: none;">
                <form action='@Url.Action("InsertarInformacionPersonal2")' method="post" id="form-modal">
                    <div>
                     @Html.TextBoxFor(model=>model.acerca_de_mi, new {placeholder="Acerca De Mi"})
                    @Html.TextBoxFor(model=>model.profesion_actual, new {placeholder="Profesion"})
                    @Html.TextBoxFor(model=>model.ubicacion, new {placeholder="Ubicacion"})
                    @Html.TextBoxFor(model=>model.foto_perfil, new {placeholder="URL Foto de Perfil"})
                    @Html.HiddenFor(model=>model.id)
                    </div>
            <div id="seccion2-footer" class="modal-footer" style="display: none;">
                <button type="button" class="btn btn-secondary" onclick="mostrarSiguienteSeccion(1)">Anterior</button>
                <button type="submit" class="btn btn-primary">Guardar</button>
            </div>
            </form>
            </div>
        </div>
    </div>
</div>

<script>
    function mostrarSiguienteSeccion(numeroSeccion) {
        if (numeroSeccion === 1) {
            $('#seccion1').show();
            $('#seccion1-body').show();
            $('#seccion1-footer').show();

            $('#seccion2').hide();
            $('#seccion2-body').hide();
            $('#seccion2-footer').hide();
        } else if (numeroSeccion === 2) {
            $('#seccion2').show();
            $('#seccion2-body').show();
            $('#seccion2-footer').show();

            $('#seccion1').hide();
            $('#seccion1-body').hide();
            $('#seccion1-footer').hide();
        }
    }
    function handleFiles(files) {
            const fileList = document.getElementById('fileList');
            const items = document.getElementsByClassName("carousel-item");

            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const listItem = document.createElement('div');
                listItem.className = 'carousel-item';

                const link = document.createElement('a');
                link.href = URL.createObjectURL(file);
                link.target = '_blank';

                const deleteButton = document.createElement('button');
                deleteButton.className = 'delete-button';
                deleteButton.textContent = '×';
                deleteButton.onclick = function() {
                    listItem.remove();
                    updateSlides();
                };

                if (file.type.startsWith('image/')) {
                    const img = document.createElement('img');
                    img.src = URL.createObjectURL(file);
                    img.alt = file.name;
                    img.className = 'd-block w-100';
                    //img.style='box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);';
                    link.appendChild(img);
                } else if (file.type.startsWith('video/')) {
                    const video = document.createElement('video');
                    video.src = URL.createObjectURL(file);
                    video.controls = true;
                    video.className = 'file-preview';
                    link.appendChild(video);
                } else if (file.type === 'application/pdf' || file.type === 'text/plain') {
                    const icon = document.createElement('img');
                    icon.src = 'ruta/a/icono/pdf_o_txt.png';
                    icon.alt = file.name;
                    icon.className = 'file-preview';
                    link.appendChild(icon);
                } else if (file.type === 'audio/mpeg') {
                    const audio = document.createElement('audio');
                    audio.src = URL.createObjectURL(file);
                    audio.controls = true;
                    audio.className = 'file-preview';
                    link.appendChild(audio);
                }

                listItem.appendChild(link);
                listItem.appendChild(deleteButton);
                fileList.appendChild(listItem);
            }
            updateSlides();
            const cantidadslides = document.getElementsByClassName('carousel-item');
            console.log(cantidadslides.length);
            // HACER UN FOREACH PARA BUSCAR SI HAY ACTIVE
            if (cantidadslides.length == 1) cantidadslides[0].classList.add('active');
        }

        function updateSlides() {
            const slides = document.getElementsByClassName('carousel-item');
            const carousel = document.getElementById('CarouseLArchivos');
            if (slides.length > 0) {
                carousel.style.display = 'block'; // Muestra el carrusel
                const bootstrapCarousel = new bootstrap.Carousel(carousel);
                document.querySelector('.carousel-control-prev').style.display = 'block';
                document.querySelector('.carousel-control-next').style.display = 'block';
            } else {
                carousel.style.display = 'none'; // Oculta el carrusel
                document.querySelector('.carousel-control-prev').style.display = 'none';
                document.querySelector('.carousel-control-next').style.display = 'none';
            }
        }
    </script>

    <script>
    function getBrightness(hex) {
    hex = hex.replace('#', '');
    var r = parseInt(hex.substring(0, 2), 16);
    var g = parseInt(hex.substring(2, 4), 16);
    var b = parseInt(hex.substring(4, 6), 16);
    return (r * 299 + g * 587 + b * 114) / 1000;
}

function adjustTextColorBasedOnBackground() {
    var card = document.querySelector('.card-container');
    var bgColor = window.getComputedStyle(card.querySelector('.rectangulo-encabezado')).backgroundColor;

    var rgb = bgColor.match(/\d+/g);
    var hex = rgb.map(x => {
        var hexPart = parseInt(x).toString(16);
        return hexPart.length === 1 ? '0' + hexPart : hexPart;
    }).join('');

    var brightness = getBrightness(hex);

    var textColor = brightness > 128 ? 'black' : 'white';
    card.style.color = textColor;
    card.querySelectorAll('.telefono, .mail, .ubicacion, .acerca_de_mi_container, #profesion').forEach(el => {
        el.style.color = textColor;
    });
}

document.addEventListener('DOMContentLoaded', adjustTextColorBasedOnBackground);
</script>

<style>
.delete-button {
    position: absolute;
    top: 10px;
    right: 10px;
    background-color: black;
    color: white;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    width: 30px;
    height: 30px;
    display: flex;
    justify-content: center;
    align-items: center;
}

.upload-container {
    text-align: center;
    margin: 20px;
}

.img_upload_archivos {
    cursor: pointer;
    max-width: 100%;
}

/*-------------------*/



.telefono {
    border-radius: 25px;
    margin-left: 160px;
    margin-right: 1px !important;
    font-size: 0.9em;
    color: inherit;
    width: 120px;
    position: absolute;
    margin-top: 35px;
    text-align: center;
    font-size: 17px;

     background-color: inherit; /* Inherit the background color from the parent */
    color: inherit; /* Inherit the text color from the parent */
    display: inline-block; /* Ensure elements are inline */
    white-space: nowrap; /* Prevent text from breaking into multiple lines */
    overflow: hidden; /* Ensure text does not overflow */
    text-overflow: ellipsis;
    
}
.mail{
    position: absolute;
    width: 200px;
    border-radius: 25px;
    text-align: center;
    margin-top: 35px;
    margin-left: 300px;
     color: inherit;

      background-color: inherit; /* Inherit the background color from the parent */
    color: inherit; /* Inherit the text color from the parent */
    display: inline-block; /* Ensure elements are inline */
    white-space: nowrap; /* Prevent text from breaking into multiple lines */
    overflow: hidden; /* Ensure text does not overflow */
    text-overflow: ellipsis;
}
.ubicacion{
    position: absolute;
    width: 100px;
    border-radius: 25px;
    text-align: center;
    margin-top: 35px;
    margin-left: 520px;
     color: inherit;

      background-color: inherit; /* Inherit the background color from the parent */
    color: inherit; /* Inherit the text color from the parent */
    display: inline-block; /* Ensure elements are inline */
    white-space: nowrap; /* Prevent text from breaking into multiple lines */
    overflow: hidden; /* Ensure text does not overflow */
    text-overflow: ellipsis;
}
.acerca-de-mi{
    width: 100%;
    text-align: justify;
    margin-top: 5%;
    align-items: center;
    padding: 10px;
}
.acerca_de_mi_container{
     
    background-color: #FEFEFE;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); 
    height: 20%;
    margin-top: 10%;
}
h5 {
    margin: 5px 0;
    font-size: 0.9em;
    color: #555;
}

button {
    border-radius: 50px !important;
}

#profesion {
    margin-left: 46%;
    border-radius: 35%;
    width: 100px;
    text-align: center;
    display: contents;
  
}
.img_upload_archivos {
  vertical-align: middle!important;
  width: 40%!important;
  border-style: none!important;
  align-items: center!important;
}



</style>